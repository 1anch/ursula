[mysqld]

datadir=/var/lib/mysql
user=mysql

wsrep_provider=/usr/lib/libgalera_smm.so

# Empty gcomm address is being used when cluster is getting bootstrapped
wsrep_cluster_address=gcomm://

wsrep_slave_threads=4

# In order for Galera to work correctly binlog format should be ROW
binlog_format=ROW

# MyISAM storage engine has only experimental support
default_storage_engine=InnoDB

# This is a recommended tuning variable for performance
innodb_locks_unsafe_for_binlog=1

# This changes how InnoDB autoincrement locks are managed and is a requirement for Galera
innodb_autoinc_lock_mode=2

#
# wsrep_sst_method={xtrabackup|mysqldum|rsync|custom_script}
#
# The downside of mysqldump and rsync is that the donor node becomes READ-ONLY while
# data is being copied from one node to another (SST applies FLUSH TABLES WITH READ LOCK command).
# Xtrabackup SST does not require READ LOCK for the entire syncing process, only for syncing the MySQL system
# tables and writing the information about the binlog, galera and slave information (same as the regular
# XtraBackup backup).
#
wsrep_sst_method=xtrabackup
wsrep_sst_auth="{{ xtradb.sst_auth_user }}:{{ xtradb.sst_auth_password }}"

# Cluster name
wsrep_cluster_name=mstack_db_cluster

# This Node's address
wsrep_node_address=

# MySQL sizing
key_buffer = 16M
query_cache_size=32M
sort_buffer_size = 1M
max_heap_table_size = 32M
query_cache_type=1
tmp_table_size = 32M
read_buffer_size = 2M
read_rnd_buffer_size = 8M
myisam_sort_buffer_size = 8M
innodb_log_buffer_size = 10M

# Other general "good idea" settings:
max_connections = 2000
interactive_timeout = 36000
wait_timeout=36000
connect_timeout=36000
# This must be <= the size of your ibdata1 file if it currently exists.
innodb_data_file_path = ibdata1:128M:autoextend
innodb_data_home_dir = /var/lib/mysql/
innodb_log_group_home_dir=/var/lib/mysql
innodb_log_files_in_group=2
innodb_file_per_table
# This must match your current log file size if these logs
# already exist.
innodb_log_file_size = 128M
innodb_flush_log_at_trx_commit = 2

thread_concurrency = 4

# Tuning for a typical server with 2GB RAM - uncomment as appropriate
table_cache = 256
thread_cache = 64
innodb_buffer_pool_size = 1G
innodb_additional_mem_pool_size = 4M
