set -e

[[ -f ~/.stackrc ]] && source ~/.stackrc
source $(dirname $0)/../share/common

export ROOT="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/.."
VMS="test-controller-0 test-controller-1 test-compute-0"
KEY_NAME=int-test
KEY_PATH=${ROOT}/envs/test/${KEY_NAME}.pem
LOGIN_USER=ubuntu
SSH_ARGS=\
" ${ANSIBLE_SSH_ARGS}"\
' -o LogLevel=quiet'\
' -o StrictHostKeyChecking=no'\
' -o UserKnownHostsFile=/dev/null'\
" -i ${KEY_PATH}"
export ANSIBLE_SSH_ARGS="${SSH_ARGS}"

die() {
  echo "[ERROR] $*"; exit 1
}

# Given a vm name, return its public ip
public_ip() {
  nova list | grep "$1" | awk '{print $13}'
}

private_ip() {
  nova list | grep "$1" | awk '{print $12}' | awk -F= '{print $2}' | awk -F, '{print $1}'
}
