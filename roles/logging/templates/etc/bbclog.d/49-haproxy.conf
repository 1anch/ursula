# Create an additional socket in haproxy's chroot in order to allow logging via
# /dev/log to chroot'ed HAProxy processes
input(
  type="imuxsock"
  Socket="/var/lib/haproxy/dev/log"
  CreatePath="on"
  RateLimit.Interval="0"
  UsePIDFromSystem="on"
)

# action(
#   type="omfile"
#   file="/var/log/haproxy.log"
#   asyncWriting="on"
#   ioBufferSize="128KiB"
# )

# Write HAProxy messages to async dedicated logfile
if $programname startswith 'haproxy' then -/var/log/haproxy.log
& stop
