# Send everything to a syslog receiver at '{{ bbclog.forward.host }}' on port {{ bbclog.forward.port }} over TCP:
action(
  type="omfwd"
  Target="{{ bbclog.forward.host }}"
  Port="{{ bbclog.forward.port }}"
  Protocol="tcp"
  template="RSYSLOG_TraditionalForwardFormat"

{% if bbclog.forward.tls.enabled %}
  StreamDriver="gtls"
  StreamDriverMode="1"
  StreamDriverAuthMode="{{ bbclog.forward.tls.authmode }}"
{% endif %}

  queue.type="LinkedList"
  queue.size="250000"
  queue.dequeuebatchsize="1000"
  queue.lowwatermark="100000"
  queue.highwatermark="200000"
  queue.discardmark="240000"
  queue.discardseverity="0" # Discard ALL messages if our queue is full
  queue.filename="omfwd-{{ bbclog.forward.host }}_{{ bbclog.forward.port }}"
  queue.maxdiskspace="10g"
  queue.checkpointinterval="1000"
  queue.workerthreads="2"
  queue.saveonshutdown="on"
)
