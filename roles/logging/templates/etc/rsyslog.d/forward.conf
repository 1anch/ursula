# Send everything to a syslog receiver named '{{ rsyslog.forward.host }}' on port {{ rsyslog.forward.port }} over TCP:
$ActionForwardDefaultTemplate RSYSLOG_TraditionalForwardFormat

{% for key, value in rsyslog.forward.config | dictsort %}
${{ key }} {{ value | replace("True", "on") | replace("False", "off") }}
{% endfor %}

{% if rsyslog.forward.tls.enabled %}
# certificate files - just CA for a client
$DefaultNetstreamDriverCAFile /usr/local/share/ca-certificates/rsyslog-forward.crt

# set up the action
# Reference: http://www.rsyslog.com/doc/ns_gtls.html
$DefaultNetstreamDriver gtls # use gtls netstream driver
$ActionSendStreamDriverMode 1 # require TLS for the connection
$ActionSendStreamDriverAuthMode {{ rsyslog.forward.tls.authmode }}
{% endif %}

*.* @@{{ rsyslog.forward.host }}:{{ rsyslog.forward.port }}
